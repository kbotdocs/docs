---
title: 이벤트 리스너 수정
category: 자습서
milestone:
  prev: learn/js/migration-to-api2
---

<Section>
  우선, 레거시 API의 이벤트 리스너를 API2의 이벤트 로직으로 수정해야 합니다. 레거시 API와 달리, API2는 이벤트 리스너의 등록 및 삭제를 프로그래머가 직접 관리하는 구조입니다.
  그러므로 기존 이벤트 리스너를 직접 등록해야 합니다.
</Section>
<Section>
  ## Bot 인스턴스 가져오기

  API2에서는 [`BotManager.getCurrentBot()`](/reference/api2/Object/BotManager/getCurrentBot) 메소드를 이용해 해당 스크립트에 대응하는 [`Bot 인스턴스`](/reference/api2/Object/Bot)를 가져올 수 있습니다.
  `Bot` 객체는 카카오톡봇을 제어하는 핵심 객체입니다.

  스크립트의 최상단에 아래 코드를 추가합니다.

  ~~~js
  const bot = BotManager.getCurrentBot();
  ~~~

  상수의 이름은 원하는 대로 설정해도 무관합니다. 해당 가이드에서는 `bot` 상수에 `Bot` 인스턴스를 할당하겠습니다. 
</Section>
<Section>
  ## 이벤트 리스너 등록하기

  이벤트 리스너의 등록은 [`Bot.addEventListener()`](/reference/api2/Object/Bot/addEventListener) 또는 [`Bot.on()`](/reference/api2/Object/Bot/on) 메소드를 사용합니다.

  우선, 레거시 API의 각 이벤트 리스너가 API2의 어떤 이벤트에 대응하는지 알아야 합니다.

  <Table>
    <Thead>
      <Tr>
        <Th colSpan="2">레거시 API의 이벤트 리스너에 대응하는 API2의 이벤트</Th>
      </Tr>
    </Thead>
    <Tbody>
      <Tr>
        <Td><span>`onBackPressed` 이벤트 리스너</span></Td>
        <Td>
          `activityBackPressed` 이벤트
        </Td>
      </Tr>
      <Tr>
        <Td><span>`void`</span></Td>
        <Td>
          [`runOnUiThread`](/reference/api2/Object/App/runOnUiThread)`(task: () => Any, onComplete: (error, result) => Any)` \
          UI쓰레드 상에서 특정 함수를 실행합니다.
        </Td>
      </Tr>
    </Tbody>
  </Table>
</Section>
